"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[433],{9433:(O,p,r)=>{r.r(p),r.d(p,{WaterQualityModule:()=>z});var c=r(177),s=r(9417),d=r(9005),y=r(8147),b=r(7038),v=r(5464),g=r(6411),F=r(115),k=r(3887),C=r(7673),E=r(5312),t=r(4438),j=r(1626);let u=(()=>{class n{constructor(e){this.http=e,this.apiUrl=`${E.c.apiUrl}/water-quality`}get(){return this.http.get(this.apiUrl)}create(e){return this.http.post(this.apiUrl,e)}update(e){return this.http.put(this.apiUrl,e)}delete(e){return this.http.delete(`${this.apiUrl}/${e}`)}getWaterParams(){return(0,C.of)([{name:"Cloro - Min 0,2 mg/l"},{name:"Coliformes Totais"},{name:"Cor aparente - 15UH"},{name:"Eschirichia Coli"},{name:"Turbidez - 5.0 UT"}])}static{this.\u0275fac=function(a){return new(a||n)(t.KVO(j.Qq))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var f=r(1188),_=r(467),Q=r(5794),h=r(9459),I=r(9743);const m=(n,o)=>({"is-invalid":n,"is-valid":o});function R(n,o){if(1&n){const e=t.RV6();t.j41(0,"div",20)(1,"h5",21),t.EFF(2,"Coleta"),t.k0s(),t.j41(3,"button",22),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.close())}),t.k0s()()}}function G(n,o){1&n&&(t.j41(0,"div",23),t.EFF(1,"V\xe1lido"),t.k0s())}function T(n,o){1&n&&(t.qex(0),t.EFF(1," N\xfamero \xe9 obrigat\xf3rio "),t.bVm())}function A(n,o){if(1&n&&(t.j41(0,"div",24),t.DNE(1,T,2,0,"ng-container",25),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.Y8G("ngIf",null==e.reference||null==e.reference.errors?null:e.reference.errors.required)}}function $(n,o){if(1&n&&(t.j41(0,"tr",26)(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.nrm(4,"input",27),t.k0s(),t.j41(5,"td"),t.nrm(6,"input",28),t.k0s(),t.j41(7,"td"),t.nrm(8,"input",29),t.k0s()()),2&n){const e=o.index,a=t.XpG();t.Y8G("formGroupName",e),t.R7$(2),t.SpI(" ",a.waterParams[e].name," "),t.R7$(2),t.Y8G("ngClass",t.l_i(5,m,a.isAnalysisInvalid(e,"required"),a.isAnalysisValid(e,"required"))),t.R7$(2),t.Y8G("ngClass",t.l_i(8,m,a.isAnalysisInvalid(e,"analyzed"),a.isAnalysisValid(e,"analyzed"))),t.R7$(2),t.Y8G("ngClass",t.l_i(11,m,a.isAnalysisInvalid(e,"conformity"),a.isAnalysisValid(e,"conformity")))}}let W=(()=>{class n{constructor(e,a,i,l){this.fb=e,this.service=a,this.activeModal=i,this.t=l,this.sent=new t.bkB,this.submitted=!1,this.waterParams=[],this.loaded=!1}ngOnInit(){this.service.getWaterParams().subscribe({next:e=>{this.waterParams=e,this.initForm()}})}initForm(){this.form=this.fb.group({reference:["",[s.k0.required,s.k0.pattern(/^\d{4}\d{2}$/)]],analysis:this.fb.array(this.waterParams.map(e=>this.createAnalysisGroup(e)))})}createAnalysisGroup(e){return this.fb.group({name:[e.name,s.k0.required],analyzed:[6,s.k0.required],required:[6,s.k0.required],conformity:[6,s.k0.required]})}onSubmit(){var e=this;return(0,_.A)(function*(){e.submitted=!0,e.form.markAllAsTouched(),e.form.valid&&e.service.create(e.form.value).subscribe({next:()=>{e.sent.emit(),e.close()},error:a=>{e.t.error(a)}})})()}markAllAsTouched(){this.form.markAllAsTouched(),this.analysisArray.controls.forEach(e=>{e.markAllAsTouched()})}isFieldInvalid(e){const a=this.form.get(e);return a?.invalid&&(a?.dirty||a?.touched)||!1}isAnalysisInvalid(e,a){const i=this.analysisArray.at(e).get(a);return this.submitted&&i?.invalid||!1}isAnalysisValid(e,a){const i=this.analysisArray.at(e).get(a);return this.submitted&&i?.valid||!1}get analysis(){return this.form.get("analysis")}get reference(){return this.form.get("reference")}get analysisArray(){return this.form.get("analysis")}close(){this.activeModal.close()}isValid(e){return this.getControl(e)?.valid&&this.submitted||!1}isInvalid(e){return this.getControl(e)?.invalid&&this.submitted||!1}getControl(e){return this.form.get(e)}static{this.\u0275fac=function(a){return new(a||n)(t.rXU(s.ok),t.rXU(u),t.rXU(d.Lw),t.rXU(Q.tw))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-water-quality-create"]],outputs:{sent:"sent"},decls:31,vars:6,consts:[[3,"ngSubmit","formGroup"],["class","modal-header",4,"ngIf"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],[1,"text-danger"],["formControlName","reference",3,"submitted"],["class","valid-feedback",4,"ngIf"],["class","invalid-feedback",4,"ngIf"],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[1,"table-dark"],["width","30%"],["width","20%"],["formArrayName","analysis"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"d-flex","justify-content-between","col-12"],["type","button","btnType","secondary","outline","",3,"click"],["type","submit","btnType","success","outline",""],[1,"modal-header"],[1,"modal-title"],["type","button","outline","","aria-label","Close",1,"btn-close",3,"click"],[1,"valid-feedback"],[1,"invalid-feedback"],[4,"ngIf"],[3,"formGroupName"],["type","text","formControlName","required",1,"form-control",3,"ngClass"],["type","text","formControlName","analyzed",1,"form-control",3,"ngClass"],["type","text","formControlName","conformity",1,"form-control",3,"ngClass"]],template:function(a,i){1&a&&(t.j41(0,"form",0),t.bIt("ngSubmit",function(){return i.onSubmit()}),t.DNE(1,R,4,0,"div",1),t.j41(2,"div",2)(3,"div",3)(4,"label",4),t.EFF(5,"Refer\xeancia: "),t.j41(6,"span",5),t.EFF(7,"*"),t.k0s()(),t.nrm(8,"app-input-reference",6),t.DNE(9,G,2,0,"div",7)(10,A,2,1,"div",8),t.k0s(),t.j41(11,"div",9)(12,"table",10)(13,"thead",11)(14,"tr")(15,"th",12),t.EFF(16,"Nome:"),t.k0s(),t.j41(17,"th",13),t.EFF(18,"Exigido:"),t.k0s(),t.j41(19,"th",13),t.EFF(20,"Analisado:"),t.k0s(),t.j41(21,"th",13),t.EFF(22,"Conforme:"),t.k0s()()(),t.j41(23,"tbody",14),t.DNE(24,$,9,14,"tr",15),t.k0s()()()(),t.j41(25,"div",16)(26,"div",17)(27,"app-button",18),t.bIt("click",function(){return i.close()}),t.EFF(28," Cancelar "),t.k0s(),t.j41(29,"app-button",19),t.EFF(30," Salvar "),t.k0s()()()()),2&a&&(t.Y8G("formGroup",i.form),t.R7$(),t.Y8G("ngIf",i.loaded),t.R7$(7),t.Y8G("submitted",i.submitted),t.R7$(),t.Y8G("ngIf",i.isValid("referencia")),t.R7$(),t.Y8G("ngIf",i.isInvalid("referencia")),t.R7$(14),t.Y8G("ngForOf",i.analysisArray.controls))},dependencies:[c.YU,c.Sq,c.bT,s.qT,s.me,s.BC,s.cb,s.j4,s.JD,s.$R,s.v8,h.Q,I.F],encapsulation:2})}}return n})(),x=(()=>{class n{constructor(e,a){this.service=e,this.activeModal=a,this.sent=new t.bkB}close(){this.activeModal.dismiss("cancel")}confirm(){this.service.delete(this.waterQuality.id).subscribe({next:()=>{this.close(),this.sent.emit()}})}static{this.\u0275fac=function(a){return new(a||n)(t.rXU(u),t.rXU(d.Lw))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-water-quality-delete"]],inputs:{waterQuality:"waterQuality"},outputs:{sent:"sent"},decls:20,vars:1,consts:[[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],[1,"text-danger","d-inline-block","remove-item-btn"],[1,"ri-delete-bin-5-fill","fs-48"],[1,"mt-4","pt-2","fs-15","mx-4","mx-sm-5"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["data-bs-dismiss","modal","id","deleteRecord-close",1,"btn","btn-link","link-success","fw-medium","text-decoration-none",3,"click"],[1,"ri-close-line","me-1","align-middle"],["type","button","id","delete-product",1,"btn","w-sm","btn-danger",3,"click"]],template:function(a,i){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"button",2),t.bIt("click",function(){return i.close()}),t.k0s()(),t.j41(3,"div",3)(4,"div",4)(5,"a",5),t.nrm(6,"i",6),t.k0s(),t.j41(7,"div",7)(8,"h4"),t.EFF(9,"Voc\xea est\xe1 certo que quer deletar isso ?"),t.k0s(),t.j41(10,"p",8),t.EFF(11,"Essa a\xe7\xe3o n\xe3o pode ser desfeita."),t.k0s(),t.j41(12,"p",8),t.EFF(13),t.k0s()()(),t.j41(14,"div",9)(15,"button",10),t.bIt("click",function(){return i.close()}),t.nrm(16,"i",11),t.EFF(17," Cancelar "),t.k0s(),t.j41(18,"button",12),t.bIt("click",function(){return i.confirm()}),t.EFF(19," Sim, Eu quero deletar! "),t.k0s()()()()),2&a&&(t.R7$(13),t.JRh(i.waterQuality.reference))},encapsulation:2})}}return n})();var N=r(6356),U=r(7186),V=r(43);function Y(n,o){if(1&n&&(t.j41(0,"td",10),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2).$implicit;t.BMQ("rowspan",e.analysis.length),t.R7$(),t.JRh(e.reference)}}function D(n,o){if(1&n){const e=t.RV6();t.j41(0,"td",10)(1,"button",13),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2).$implicit,l=t.XpG(2);return t.Njj(l.delete(i))}),t.nrm(2,"i",14),t.k0s()()}if(2&n){const e=t.XpG(2).$implicit;t.BMQ("rowspan",e.analysis.length)}}function X(n,o){if(1&n&&(t.qex(0),t.j41(1,"tr"),t.DNE(2,Y,2,2,"td",12),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.DNE(11,D,3,1,"td",12),t.k0s(),t.bVm()),2&n){const e=o.$implicit,a=o.index;t.R7$(2),t.Y8G("ngIf",0==a),t.R7$(2),t.JRh(e.name),t.R7$(2),t.JRh(e.analyzed),t.R7$(2),t.JRh(e.conformity),t.R7$(2),t.JRh(e.required),t.R7$(),t.Y8G("ngIf",0==a)}}function M(n,o){if(1&n&&(t.qex(0),t.DNE(1,X,12,6,"ng-container",11),t.bVm()),2&n){const e=o.$implicit;t.R7$(),t.Y8G("ngForOf",e.analysis)}}function w(n,o){if(1&n&&(t.j41(0,"app-card-body")(1,"div",6)(2,"table",7)(3,"thead")(4,"tr")(5,"th",8),t.EFF(6,"Refer\xeancias"),t.k0s(),t.j41(7,"th",9),t.EFF(8,"Parametro"),t.k0s(),t.j41(9,"th",8),t.EFF(10,"Exigido"),t.k0s(),t.j41(11,"th",8),t.EFF(12,"Analisado"),t.k0s(),t.j41(13,"th",8),t.EFF(14,"Conforme"),t.k0s(),t.j41(15,"th",10),t.EFF(16,"A\xe7\xf5es"),t.k0s()()(),t.j41(17,"tbody"),t.DNE(18,M,2,1,"ng-container",11),t.k0s()()()()),2&n){const e=t.XpG();t.R7$(18),t.Y8G("ngForOf",e.analises)}}const S=[{path:"",component:(()=>{class n{constructor(e,a){this.service=e,this.modalService=a,this.analises=[],this.ready=!1}ngOnInit(){this.search()}search(){this.ready=!1,this.service.get().subscribe({next:e=>{this.analises=e,this.ready=!0},error:()=>{this.ready=!1}})}create(){this.openModal(W)}delete(e){this.openModal(x,{waterQuality:e})}openModal(e,a){const l=this.modalService.open(e,{centered:!0}).componentInstance;a&&Object.assign(l,a),l.sent.subscribe(()=>this.search())}static{this.\u0275fac=function(a){return new(a||n)(t.rXU(u),t.rXU(d.Bq))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-water-quality"]],decls:10,vars:1,consts:[[1,"row"],[1,"col-lg-12"],[1,"card-title","flex-grow-1","mb-0"],[1,"d-flex","gap-1","flex-wrap"],["btnType","success","outline","",3,"click"],[4,"ngIf"],[1,"table-responsive","table-card"],[1,"table","table-hover","table-striped","table-bordered","align-middle","table-nowrap","mb-0","table-gridjs"],[1,"col-1"],[1,"col-7"],[1,"text-center"],[4,"ngFor","ngForOf"],["class","text-center",4,"ngIf"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"ri-delete-bin-5-fill"]],template:function(a,i){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"app-card")(3,"app-card-header")(4,"h5",2),t.EFF(5,"Coleta"),t.k0s(),t.j41(6,"div",3)(7,"app-button",4),t.bIt("click",function(){return i.create()}),t.EFF(8,"Adicionar"),t.k0s()()(),t.DNE(9,w,19,1,"app-card-body",5),t.k0s()()()),2&a&&(t.R7$(9),t.Y8G("ngIf",i.ready))},dependencies:[c.Sq,c.bT,h.Q,N.i,U.l,V.q],encapsulation:2})}}return n})()}];let B=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[f.iI.forChild(S),f.iI]})}}return n})(),z=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({providers:[u],imports:[v.M.pick(g.Wzl),c.MD,B,k.G,y.h,s.X1,d.c9,F.i,s.YN,b.H]})}}return n})()}}]);