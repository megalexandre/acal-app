"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[371],{371:(te,f,s)=>{s.r(f),s.d(f,{WaterQualityModule:()=>ee});var c=s(177),o=s(9417),d=s(9005),y=s(8147),b=s(7038),g=s(5464),F=s(6411),C=s(115),k=s(3887),_=s(7673),E=s(5312),e=s(4438),j=s(1626);let u=(()=>{class n{constructor(t){this.http=t,this.apiUrl=`${E.c.apiUrl}/water-quality`}get(){return this.http.get(this.apiUrl)}create(t){return this.http.post(this.apiUrl,t)}update(t){return this.http.put(this.apiUrl,t)}delete(t){return this.http.delete(`${this.apiUrl}/${t}`)}getWaterParams(){return(0,_.of)([{name:"Cloro - Min 0,2 mg/l"},{name:"Coliformes Totais"},{name:"Cor aparente - 15UH"},{name:"Eschirichia Coli"},{name:"Turbidez - 5.0 UT"}])}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(j.Qq))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var p=s(1188),I=s(467),h=s(9459);class R{static valid(){return a=>{const t=a.value;if(!t)return null;const i=t.substring(0,4),r=t.substring(4,6),l=parseInt(i,10),v=parseInt(r,10);return l<1900?{invalidYear:!0}:v<1||v>12?{invalidMonth:!0}:null}}}var T=s(9830);const G=(n,a)=>({"is-invalid":n,"is-valid":a});function A(n,a){1&n&&(e.j41(0,"div"),e.EFF(1,"Campo obrigat\xf3rio"),e.k0s())}function $(n,a){1&n&&(e.j41(0,"div"),e.EFF(1,"Formato inv\xe1lido (use YYYY-MM)"),e.k0s())}function Q(n,a){1&n&&(e.j41(0,"div"),e.EFF(1,"Ano deve ser maior que 1900"),e.k0s())}function Y(n,a){1&n&&(e.j41(0,"div"),e.EFF(1,"M\xeas deve ser entre 01 e 12"),e.k0s())}function x(n,a){if(1&n&&(e.j41(0,"div",2),e.DNE(1,A,2,0,"div",3)(2,$,2,0,"div",3)(3,Q,2,0,"div",3)(4,Y,2,0,"div",3),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.reference.hasError("required")),e.R7$(),e.Y8G("ngIf",t.reference.hasError("pattern")),e.R7$(),e.Y8G("ngIf",t.reference.hasError("invalidYear")),e.R7$(),e.Y8G("ngIf",t.reference.hasError("invalidMonth"))}}let V=(()=>{class n{constructor(){this.placeholder="YYYY-MM"}ngOnChanges(t){t.reference&&this.reference&&(this.reference.setValidators([...this.reference.validator?[this.reference.validator]:[],o.k0.required,R.valid()]),this.reference.updateValueAndValidity()),t.submitted&&!0===t.submitted.currentValue&&!0!==t.submitted.previousValue&&(this.reference.markAsTouched(),this.reference.updateValueAndValidity())}isInvalid(){return!!this.submitted&&this.reference?.touched&&this.reference?.invalid}isValid(){return!!this.submitted&&this.reference?.touched&&this.reference?.valid}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-input-reference"]],inputs:{reference:"reference",submitted:"submitted",placeholder:"placeholder"},features:[e.OA$],decls:2,vars:7,consts:[["type","text","mask","0000-00",1,"form-control",3,"formControl","ngClass","placeholder"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(i,r){1&i&&(e.nrm(0,"input",0),e.DNE(1,x,5,4,"div",1)),2&i&&(e.Y8G("formControl",r.reference)("ngClass",e.l_i(4,G,r.isInvalid(),r.isValid()))("placeholder",r.placeholder),e.R7$(),e.Y8G("ngIf",r.isInvalid()))},dependencies:[c.YU,c.bT,o.me,o.BC,o.l_,T.Zr],encapsulation:2})}}return n})();const m=(n,a)=>({"is-invalid":n,"is-valid":a});function W(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",20)(1,"h5",21),e.EFF(2,"Coleta"),e.k0s(),e.j41(3,"button",22),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.close())}),e.k0s()()}}function N(n,a){1&n&&(e.j41(0,"div",23),e.EFF(1,"V\xe1lido"),e.k0s())}function M(n,a){1&n&&(e.qex(0),e.EFF(1," N\xfamero \xe9 obrigat\xf3rio "),e.bVm())}function U(n,a){if(1&n&&(e.j41(0,"div",24),e.DNE(1,M,2,0,"ng-container",25),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",null==t.reference||null==t.reference.errors?null:t.reference.errors.required)}}function D(n,a){if(1&n&&(e.j41(0,"tr",26)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.nrm(4,"input",27),e.k0s(),e.j41(5,"td"),e.nrm(6,"input",28),e.k0s(),e.j41(7,"td"),e.nrm(8,"input",29),e.k0s()()),2&n){const t=a.index,i=e.XpG();e.Y8G("formGroupName",t),e.R7$(2),e.SpI(" ",i.waterParams[t].name," "),e.R7$(2),e.Y8G("ngClass",e.l_i(5,m,i.isAnalysisInvalid(t,"required"),i.isAnalysisValid(t,"required"))),e.R7$(2),e.Y8G("ngClass",e.l_i(8,m,i.isAnalysisInvalid(t,"analyzed"),i.isAnalysisValid(t,"analyzed"))),e.R7$(2),e.Y8G("ngClass",e.l_i(11,m,i.isAnalysisInvalid(t,"conformity"),i.isAnalysisValid(t,"conformity")))}}let X=(()=>{class n{constructor(t,i,r){this.fb=t,this.service=i,this.activeModal=r,this.sent=new e.bkB,this.submitted=!1,this.waterParams=[],this.loaded=!1}ngOnInit(){this.service.getWaterParams().subscribe({next:t=>{this.waterParams=t,this.initForm()}})}initForm(){this.form=this.fb.group({reference:["",[o.k0.required,o.k0.pattern(/^\d{4}\d{2}$/)]],analysis:this.fb.array(this.waterParams.map(t=>this.createAnalysisGroup(t)))})}createAnalysisGroup(t){return this.fb.group({name:[t.name,o.k0.required],analyzed:[6,o.k0.required],required:[6,o.k0.required],conformity:[6,o.k0.required]})}onSubmit(){var t=this;return(0,I.A)(function*(){t.submitted=!0,t.form.markAllAsTouched(),t.form.valid&&t.service.create(t.form.value).subscribe({next:()=>{t.sent.emit(),t.close()},error:i=>{t.form.reset()}})})()}markAllAsTouched(){this.form.markAllAsTouched(),this.analysisArray.controls.forEach(t=>{t.markAllAsTouched()})}isFieldInvalid(t){const i=this.form.get(t);return i?.invalid&&(i?.dirty||i?.touched)||!1}isAnalysisInvalid(t,i){const r=this.analysisArray.at(t).get(i);return this.submitted&&r?.invalid||!1}isAnalysisValid(t,i){const r=this.analysisArray.at(t).get(i);return this.submitted&&r?.valid||!1}get analysis(){return this.form.get("analysis")}get reference(){return this.form.get("reference")}get analysisArray(){return this.form.get("analysis")}close(){this.activeModal.close()}isValid(t){return this.getControl(t)?.valid&&this.submitted||!1}isInvalid(t){return this.getControl(t)?.invalid&&this.submitted||!1}getControl(t){return this.form.get(t)}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(o.ok),e.rXU(u),e.rXU(d.Lw))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-water-quality-create"]],outputs:{sent:"sent"},decls:31,vars:7,consts:[[3,"ngSubmit","formGroup"],["class","modal-header",4,"ngIf"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],[1,"text-danger"],[3,"reference","submitted"],["class","valid-feedback",4,"ngIf"],["class","invalid-feedback",4,"ngIf"],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[1,"table-dark"],["width","30%"],["width","20%"],["formArrayName","analysis"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"d-flex","justify-content-between","col-12"],["type","button","btnType","secondary","outline","",3,"click"],["type","submit","btnType","success","outline",""],[1,"modal-header"],[1,"modal-title"],["type","button","outline","","aria-label","Close",1,"btn-close",3,"click"],[1,"valid-feedback"],[1,"invalid-feedback"],[4,"ngIf"],[3,"formGroupName"],["type","text","formControlName","required",1,"form-control",3,"ngClass"],["type","text","formControlName","analyzed",1,"form-control",3,"ngClass"],["type","text","formControlName","conformity",1,"form-control",3,"ngClass"]],template:function(i,r){1&i&&(e.j41(0,"form",0),e.bIt("ngSubmit",function(){return r.onSubmit()}),e.DNE(1,W,4,0,"div",1),e.j41(2,"div",2)(3,"div",3)(4,"label",4),e.EFF(5,"Refer\xeancia: "),e.j41(6,"span",5),e.EFF(7,"*"),e.k0s()(),e.nrm(8,"app-input-reference",6),e.DNE(9,N,2,0,"div",7)(10,U,2,1,"div",8),e.k0s(),e.j41(11,"div",9)(12,"table",10)(13,"thead",11)(14,"tr")(15,"th",12),e.EFF(16,"Nome:"),e.k0s(),e.j41(17,"th",13),e.EFF(18,"Exigido:"),e.k0s(),e.j41(19,"th",13),e.EFF(20,"Analisado:"),e.k0s(),e.j41(21,"th",13),e.EFF(22,"Conforme:"),e.k0s()()(),e.j41(23,"tbody",14),e.DNE(24,D,9,14,"tr",15),e.k0s()()()(),e.j41(25,"div",16)(26,"div",17)(27,"app-button",18),e.bIt("click",function(){return r.close()}),e.EFF(28," Cancelar "),e.k0s(),e.j41(29,"app-button",19),e.EFF(30," Salvar "),e.k0s()()()()),2&i&&(e.Y8G("formGroup",r.form),e.R7$(),e.Y8G("ngIf",r.loaded),e.R7$(7),e.Y8G("reference",r.reference)("submitted",r.submitted),e.R7$(),e.Y8G("ngIf",r.isValid("referencia")),e.R7$(),e.Y8G("ngIf",r.isInvalid("referencia")),e.R7$(14),e.Y8G("ngForOf",r.analysisArray.controls))},dependencies:[c.YU,c.Sq,c.bT,o.qT,o.me,o.BC,o.cb,o.j4,o.JD,o.$R,o.v8,h.Q,V],encapsulation:2})}}return n})(),w=(()=>{class n{constructor(t,i){this.service=t,this.activeModal=i,this.sent=new e.bkB}close(){this.activeModal.dismiss("cancel")}confirm(){this.service.delete(this.waterQuality.id).subscribe({next:()=>{this.close(),this.sent.emit()}})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(u),e.rXU(d.Lw))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-water-quality-delete"]],inputs:{waterQuality:"waterQuality"},outputs:{sent:"sent"},decls:20,vars:1,consts:[[1,"modal-content"],[1,"modal-header"],["type","button","data-bs-dismiss","modal","aria-label","Close","id","btn-close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mt-2","text-center"],[1,"text-danger","d-inline-block","remove-item-btn"],[1,"ri-delete-bin-5-fill","fs-48"],[1,"mt-4","pt-2","fs-15","mx-4","mx-sm-5"],[1,"text-muted","mx-4","mb-0"],[1,"d-flex","gap-2","justify-content-center","mt-4","mb-2"],["data-bs-dismiss","modal","id","deleteRecord-close",1,"btn","btn-link","link-success","fw-medium","text-decoration-none",3,"click"],[1,"ri-close-line","me-1","align-middle"],["type","button","id","delete-product",1,"btn","w-sm","btn-danger",3,"click"]],template:function(i,r){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"button",2),e.bIt("click",function(){return r.close()}),e.k0s()(),e.j41(3,"div",3)(4,"div",4)(5,"a",5),e.nrm(6,"i",6),e.k0s(),e.j41(7,"div",7)(8,"h4"),e.EFF(9,"Voc\xea est\xe1 certo que quer deletar isso ?"),e.k0s(),e.j41(10,"p",8),e.EFF(11,"Essa a\xe7\xe3o n\xe3o pode ser desfeita."),e.k0s(),e.j41(12,"p",8),e.EFF(13),e.k0s()()(),e.j41(14,"div",9)(15,"button",10),e.bIt("click",function(){return r.close()}),e.nrm(16,"i",11),e.EFF(17," Cancelar "),e.k0s(),e.j41(18,"button",12),e.bIt("click",function(){return r.confirm()}),e.EFF(19," Sim, Eu quero deletar! "),e.k0s()()()()),2&i&&(e.R7$(13),e.JRh(r.waterQuality.reference))},encapsulation:2})}}return n})();var S=s(7509),B=s(6356),O=s(7186),q=s(43);function z(n,a){if(1&n&&(e.j41(0,"td",10),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2).$implicit;e.BMQ("rowspan",t.analysis.length),e.R7$(),e.JRh(t.reference)}}function J(n,a){if(1&n){const t=e.RV6();e.j41(0,"td",10)(1,"button",13),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2).$implicit,l=e.XpG(2);return e.Njj(l.delete(r))}),e.nrm(2,"i",14),e.k0s()()}if(2&n){const t=e.XpG(2).$implicit;e.BMQ("rowspan",t.analysis.length)}}function P(n,a){if(1&n&&(e.qex(0),e.j41(1,"tr"),e.DNE(2,z,2,2,"td",12),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.DNE(11,J,3,1,"td",12),e.k0s(),e.bVm()),2&n){const t=a.$implicit,i=a.index;e.R7$(2),e.Y8G("ngIf",0==i),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.analyzed),e.R7$(2),e.JRh(t.conformity),e.R7$(2),e.JRh(t.required),e.R7$(),e.Y8G("ngIf",0==i)}}function H(n,a){if(1&n&&(e.qex(0),e.DNE(1,P,12,6,"ng-container",11),e.bVm()),2&n){const t=a.$implicit;e.R7$(),e.Y8G("ngForOf",t.analysis)}}function L(n,a){if(1&n&&(e.j41(0,"app-card-body")(1,"div",6)(2,"table",7)(3,"thead")(4,"tr")(5,"th",8),e.EFF(6,"Refer\xeancias"),e.k0s(),e.j41(7,"th",9),e.EFF(8,"Parametro"),e.k0s(),e.j41(9,"th",8),e.EFF(10,"Exigido"),e.k0s(),e.j41(11,"th",8),e.EFF(12,"Analisado"),e.k0s(),e.j41(13,"th",8),e.EFF(14,"Conforme"),e.k0s(),e.j41(15,"th",10),e.EFF(16,"A\xe7\xf5es"),e.k0s()()(),e.j41(17,"tbody"),e.DNE(18,H,2,1,"ng-container",11),e.k0s()()()()),2&n){const t=e.XpG();e.R7$(18),e.Y8G("ngForOf",t.analises)}}const K=[{path:"",component:(()=>{class n{constructor(t,i,r){this.service=t,this.modalService=i,this.toastService=r,this.analises=[],this.ready=!1}ngOnInit(){this.search()}search(){this.ready=!1,this.service.get().subscribe({next:t=>{this.analises=t,this.ready=!0},error:()=>{this.ready=!1}})}create(){this.openModal(X)}delete(t){this.openModal(w,{waterQuality:t})}openModal(t,i){const l=this.modalService.open(t,{centered:!0}).componentInstance;i&&Object.assign(l,i),l.sent.subscribe(()=>this.search())}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(u),e.rXU(d.Bq),e.rXU(S.f))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-water-quality"]],decls:10,vars:1,consts:[[1,"row"],[1,"col-lg-12"],[1,"card-title","flex-grow-1","mb-0"],[1,"d-flex","gap-1","flex-wrap"],["btnType","success","outline","",3,"click"],[4,"ngIf"],[1,"table-responsive","table-card"],[1,"table","table-hover","table-striped","table-bordered","align-middle","table-nowrap","mb-0","table-gridjs"],[1,"col-1"],[1,"col-7"],[1,"text-center"],[4,"ngFor","ngForOf"],["class","text-center",4,"ngIf"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"ri-delete-bin-5-fill"]],template:function(i,r){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"app-card")(3,"app-card-header")(4,"h5",2),e.EFF(5,"Coleta"),e.k0s(),e.j41(6,"div",3)(7,"app-button",4),e.bIt("click",function(){return r.create()}),e.EFF(8,"Adicionar"),e.k0s()()(),e.DNE(9,L,19,1,"app-card-body",5),e.k0s()()()),2&i&&(e.R7$(9),e.Y8G("ngIf",r.ready))},dependencies:[c.Sq,c.bT,h.Q,B.i,O.l,q.q],encapsulation:2})}}return n})()}];let Z=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[p.iI.forChild(K),p.iI]})}}return n})(),ee=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({providers:[u],imports:[g.M.pick(F.Wzl),c.MD,Z,k.G,y.h,o.X1,d.c9,C.i,o.YN,b.H]})}}return n})()}}]);