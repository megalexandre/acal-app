<app-breadcrumbs title="Coleta" [breadcrumbItems]="breadCrumbItems"></app-breadcrumbs>

<div class="row">
  <div class="col-lg-12">
    <app-card>
      <app-card-header>
        <h5 class="card-title flex-grow-1 mb-0">Coleta</h5>
        <div class="d-flex gap-1 flex-wrap">
          <app-button btnType="success" outline (click)="create()">Adicionar</app-button>
        </div>
      </app-card-header>

      <app-card-body>
        <div class="table-responsive table-card">
          <table class="table table-hover table-striped align-middle table-nowrap mb-0 table-gridjs">
            <thead>
              <tr>
                <th class="col-1">Referências</th>
                <th class="col-7">Parametro</th>
                <th class="col-1">Exigido</th>
                <th class="col-1">Analisado</th>
                <th class="col-1">Conforme</th>
                
                <th class="col-1" class="text-center">Ações</th>
              </tr>
            </thead>

            <tbody>

              <ng-container *ngFor="let analise of analises; let x = index">
                <ng-container *ngFor="let a of analise.analysis; let y = index">
                
                  <tr>
                    <td [attr.rowspan]="analise.analysis.length" *ngIf="y == 0" class="text-center">{{ analise.reference }}</td>
                    
                    <td>{{ a.name }}</td>
                    <td>{{ a.analyzed }}</td>
                    <td>{{ a.conformity }}</td>
                    <td>{{ a.required }}</td>

                    <td [attr.rowspan]="analise.analysis.length" class="text-center" *ngIf="y == 0">
                      <button class="btn btn-sm btn-danger" (click)="delete(analise)">
                        <i class="ri-delete-bin-5-fill"></i>
                      </button>
                    </td>
                  </tr>
                
                </ng-container>
              </ng-container>
              
              <!-- 
              <tr *ngFor="let a of analises">
                <td [attr.rowspan]="a.analises.length">{{ a.reference }}</td>
                <td>{{ a.analysis }}</td>
                <td class="text-center">
                  <button class="btn btn-sm btn-primary me-1" (click)="edit(a)">
                    <i class="ri-pencil-fill"></i>
                  </button>
                  <button class="btn btn-sm btn-danger" (click)="delete(a)">
                    <i class="ri-delete-bin-5-fill"></i>
                  </button>
                </td>
              </tr>
              -->
            </tbody>
          </table>

        </div>
      </app-card-body>

      <div *ngIf="loaded" class="text-center p-3">
        <div class="spinner-border text-primary" role="status"></div>
      </div>
    </app-card>
  </div>
</div>
