"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[990],{990:(D,m,o)=>{o.r(m),o.d(m,{WaterMeterModule:()=>J});var l=o(177),i=o(9417),F=o(7810),b=o(8147),k=o(7038),j=o(5464),C=o(6411),E=o(1728),M=o(3887),d=o(1188),t=o(4438),y=o(5312),R=o(1626);let u=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${y.c.apiUrl}/water-meter`}paginate(e){return this.http.post(`${this.apiUrl}/paginate`,e)}preview(e){return this.http.get(`${this.apiUrl}/preview/${e}`)}create(e){return this.http.post(`${this.apiUrl}/all`,e)}static{this.\u0275fac=function(n){return new(n||r)(t.KVO(R.Qq))}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var I=o(9459),h=o(6356),f=o(7186),g=o(43),T=o(272),$=o(1272),v=o(6436);function G(r,c){if(1&r&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.nI1(3,"reference"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td"),t.EFF(7),t.nI1(8,"number"),t.k0s(),t.j41(9,"td"),t.EFF(10),t.nI1(11,"number"),t.k0s(),t.j41(12,"td"),t.EFF(13),t.nI1(14,"number"),t.k0s(),t.j41(15,"td"),t.EFF(16),t.nI1(17,"number"),t.k0s(),t.j41(18,"td"),t.EFF(19),t.nI1(20,"currency"),t.k0s()()),2&r){const e=c.$implicit;t.R7$(2),t.JRh(t.bMT(3,7,e.reference)),t.R7$(3),t.JRh(e.link_name),t.R7$(2),t.JRh(t.bMT(8,9,e.start)),t.R7$(3),t.JRh(t.bMT(11,11,e.end)),t.R7$(3),t.JRh(t.bMT(14,13,e.consumption_total)),t.R7$(3),t.JRh(t.bMT(17,15,e.paid_usage_value)),t.R7$(3),t.JRh(t.bMT(20,17,e.total))}}let x=(()=>{class r{constructor(e,n,a){this.service=e,this.router=n,this.route=a,this.loading=!1}create(){this.router.navigate(["create"],{relativeTo:this.route,state:{}})}trackById(e,n){return n.id}ngOnInit(){this.search()}search(){this.loading=!1,this.service.paginate({}).subscribe({next:e=>{this.page=e,this.loading=!1},error:()=>{this.loading=!1}})}onPageChange(e){setTimeout(()=>{this.search()})}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(u),t.rXU(d.Ix),t.rXU(d.nX))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-water-meter"]],decls:48,vars:3,consts:[[1,"accordion","w-100","mb-3"],[1,"accordion-item"],["id","headingOne",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseOne","aria-expanded","false","aria-controls","collapseOne",1,"accordion-button","collapsed"],["id","collapseOne","aria-labelledby","headingOne","data-bs-parent","#accordionExample",1,"accordion-collapse","collapse"],[1,"accordion-body"],[1,"row"],[1,"col-6","col-md-2","offset-md-8","mb-3"],["type","button",1,"btn","btn-outline-info","w-100"],[1,"mdi","mdi-magnify"],[1,"col-6","col-md-2"],["type","button",1,"btn","btn-outline-primary","w-100"],[1,"col-lg-12"],[1,"card-title","flex-grow-1","mb-0"],[1,"d-flex","gap-1","flex-wrap"],["btnType","success","outline","",3,"click"],[1,"table-responsive","table-card"],[1,"table","table-striped","table-borded","align-middle","table-nowrap","mb-0"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"pageChange","page"]],template:function(n,a){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2)(3,"button",3),t.EFF(4,"Filtros"),t.k0s()(),t.j41(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"button",8),t.nrm(10,"i",9),t.EFF(11," Limpar"),t.k0s()(),t.j41(12,"div",10)(13,"button",11),t.nrm(14,"i",9),t.EFF(15," Buscar"),t.k0s()()()()()()(),t.j41(16,"div",6)(17,"div",12)(18,"app-card")(19,"app-card-header")(20,"h5",13),t.EFF(21,"Hidr\xf4metros"),t.k0s(),t.j41(22,"div",14)(23,"app-button",15),t.bIt("click",function(){return a.create()}),t.EFF(24,"Adicionar "),t.k0s()()(),t.j41(25,"app-card-body")(26,"div",16)(27,"table",17)(28,"thead")(29,"tr")(30,"th"),t.EFF(31,"Refer\xeancia:"),t.k0s(),t.j41(32,"th"),t.EFF(33,"Nome:"),t.k0s(),t.j41(34,"th"),t.EFF(35,"M\xeas Anterior:"),t.k0s(),t.j41(36,"th"),t.EFF(37,"M\xeas Atual:"),t.k0s(),t.j41(38,"th"),t.EFF(39,"Consumo:"),t.k0s(),t.j41(40,"th"),t.EFF(41,"Consumo considerado:"),t.k0s(),t.j41(42,"th"),t.EFF(43,"Total:"),t.k0s()()(),t.j41(44,"tbody"),t.DNE(45,G,21,19,"tr",18),t.k0s()()()(),t.j41(46,"app-card-footer")(47,"app-pagination",19),t.bIt("pageChange",function(p){return a.onPageChange(p)}),t.k0s()()()()()),2&n&&(t.R7$(45),t.Y8G("ngForOf",null==a.page?null:a.page.content)("ngForTrackBy",a.trackById),t.R7$(2),t.Y8G("page",a.page))},dependencies:[l.Sq,I.Q,h.i,f.l,g.q,T.R,$.e,l.QX,l.oe,v.o],encapsulation:2})}}return r})();var W=o(5794),_=o(9986),X=o(4988),N=o(9830);function B(r,c){if(1&r){const e=t.RV6();t.j41(0,"app-card")(1,"app-card-body")(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),t.EFF(6,"Refer\xeancia"),t.k0s(),t.j41(7,"app-input-reference",6),t.mxI("ngModelChange",function(a){t.eBV(e);const s=t.XpG();return t.DH7(s.reference,a)||(s.reference=a),t.Njj(a)}),t.bIt("keydown.enter",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.search())}),t.k0s()()(),t.nrm(8,"hr"),t.j41(9,"div",7)(10,"div",8)(11,"label",9),t.EFF(12,"voltar"),t.k0s(),t.j41(13,"button",10),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.back())}),t.nrm(14,"i",11),t.EFF(15," Voltar"),t.k0s()(),t.j41(16,"div",12)(17,"label",9),t.EFF(18,"Buscar"),t.k0s(),t.j41(19,"button",13),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.search())}),t.nrm(20,"i",11),t.EFF(21," Buscar"),t.k0s()()()()()()}if(2&r){const e=t.XpG();t.R7$(7),t.R50("ngModel",e.reference)}}function O(r,c){1&r&&(t.j41(0,"div",24),t.EFF(1,"Obrigat\xf3rio"),t.k0s())}function U(r,c){1&r&&(t.j41(0,"div",24),t.EFF(1,"Obrigat\xf3rio"),t.k0s())}function A(r,c){if(1&r&&(t.j41(0,"tr",20)(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.nrm(4,"input",21),t.DNE(5,O,2,0,"div",22),t.k0s(),t.j41(6,"td"),t.nrm(7,"input",23),t.DNE(8,U,2,0,"div",22),t.k0s()()),2&r){let e,n,a;const s=c.$implicit;t.Y8G("formGroupName",c.index),t.R7$(2),t.JRh(null==(e=s.get("link_name"))?null:e.value),t.R7$(2),t.Y8G("dropSpecialCharacters",!0),t.R7$(),t.Y8G("ngIf",(null==(n=s.get("start"))?null:n.invalid)&&(null==(n=s.get("start"))?null:n.touched)),t.R7$(2),t.Y8G("dropSpecialCharacters",!0),t.R7$(),t.Y8G("ngIf",(null==(a=s.get("end"))?null:a.invalid)&&(null==(a=s.get("end"))?null:a.touched))}}function V(r,c){if(1&r){const e=t.RV6();t.j41(0,"div",7)(1,"div",14)(2,"app-card")(3,"app-card-header")(4,"h5",15),t.EFF(5),t.nI1(6,"reference"),t.k0s()(),t.j41(7,"app-card-body")(8,"form",16)(9,"app-table")(10,"thead",17)(11,"tr")(12,"th"),t.EFF(13,"Link:"),t.k0s(),t.j41(14,"th"),t.EFF(15,"M\xeas Passado:"),t.k0s(),t.j41(16,"th"),t.EFF(17),t.k0s()()(),t.j41(18,"tbody",18),t.DNE(19,A,9,6,"tr",19),t.k0s()()()()(),t.j41(20,"div",7)(21,"div",8)(22,"button",10),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.back())}),t.nrm(23,"i",11),t.EFF(24," Voltar"),t.k0s()(),t.j41(25,"div",12)(26,"button",13),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.save())}),t.nrm(27,"i",11),t.EFF(28," Salvar"),t.k0s()()()()()}if(2&r){const e=t.XpG();t.R7$(5),t.JRh(t.bMT(6,4,e.reference)),t.R7$(3),t.Y8G("formGroup",e.form),t.R7$(9),t.SpI("M\xeas Atual: ",e.reference,""),t.R7$(2),t.Y8G("ngForOf",e.items.controls)}}const Y=[{path:"",component:x},{path:"create",component:(()=>{class r{constructor(e,n,a,s,p){this.fb=e,this.service=n,this.t=a,this.router=s,this.route=p,this.hasRefernece=!1,this.loading=!0,this.reference="",this.form=this.fb.group({items:this.fb.array([])})}ngOnInit(){}get items(){return this.form.get("items")}createItem(e){return this.fb.group({id:[e.id,i.k0.required],reference:[e.reference,i.k0.required],link_id:[e.link_id,i.k0.required],link_name:[e.link_name],price_per_unit:[e.price_per_unit,i.k0.required],free_tier:[e.free_tier,i.k0.required],start:[e.start,i.k0.required],end:[e.end,i.k0.required]})}search(){this.loading=!0,this.hasRefernece=!0,this.service.preview(this.reference).subscribe({next:e=>{this.items.clear(),e.forEach(n=>this.items.push(this.createItem(n))),this.loading=!1},error:()=>{this.loading=!1}})}save(){this.form.invalid?this.form.markAllAsTouched():this.service.create(this.form.value.items).subscribe({next:()=>{this.back()},error:e=>{this.t.error(e)}})}back(){this.router.navigate(["../"],{relativeTo:this.route})}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(i.ok),t.rXU(u),t.rXU(W.tw),t.rXU(d.Ix),t.rXU(d.nX))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-water-meter-create"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","row",4,"ngIf"],[1,"container-fluid"],[1,"row","g-2","align-items-end"],[1,"col-md-6","col-12"],[1,"form-label"],[3,"ngModelChange","keydown.enter","ngModel"],[1,"row"],[1,"col-6","col-md-2","offset-md-8","d-grid"],[1,"form-label","invisible"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"mdi","mdi-magnify"],[1,"col-6","col-md-2","d-grid"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"col-lg-12"],[1,"card-title","flex-grow-1","mb-0"],[3,"formGroup"],["table-header",""],["table-body","","formArrayName","items"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["type","number","mask","0*","thousandSeparator",".","formControlName","start",1,"form-control",3,"dropSpecialCharacters"],["class","text-danger",4,"ngIf"],["type","number","mask","0*","thousandSeparator",".","formControlName","end",1,"form-control",3,"dropSpecialCharacters"],[1,"text-danger"]],template:function(n,a){1&n&&t.DNE(0,B,22,1,"app-card",0)(1,V,29,6,"div",1),2&n&&(t.Y8G("ngIf",!a.hasRefernece),t.R7$(),t.Y8G("ngIf",a.hasRefernece))},dependencies:[l.Sq,l.bT,i.qT,i.me,i.Q0,i.BC,i.cb,i.j4,i.JD,i.$R,i.v8,h.i,f.l,g.q,_.O,X.F,i.vS,N.Zr,v.o],encapsulation:2})}}return r})()}];let S=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=t.$C({type:r})}static{this.\u0275inj=t.G2t({imports:[d.iI.forChild(Y),d.iI]})}}return r})(),J=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=t.$C({type:r})}static{this.\u0275inj=t.G2t({providers:[u],imports:[j.M.pick(C.Wzl),S,l.MD,M.G,b.h,i.X1,F.c9,E.i,i.YN,k.H]})}}return r})()}}]);