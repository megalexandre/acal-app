"use strict";(self.webpackChunkvelzon=self.webpackChunkvelzon||[]).push([[362],{272:(E,f,s)=>{s.d(f,{R:()=>g});var o=s(4438);const l=["*"];let g=(()=>{class v{static{this.\u0275fac=function(F){return new(F||v)}}static{this.\u0275cmp=o.VBU({type:v,selectors:[["app-card-footer"]],ngContentSelectors:l,decls:2,vars:0,consts:[[1,"card-footer"]],template:function(F,c){1&F&&(o.NAR(),o.j41(0,"div",0),o.SdG(1),o.k0s())},encapsulation:2})}}return v})()},1272:(E,f,s)=>{s.d(f,{e:()=>C});var o=s(4438),l=s(177),g=s(9459);function v(m,F){if(1&m){const c=o.RV6();o.j41(0,"div",1)(1,"div",2)(2,"div")(3,"strong"),o.EFF(4,"Total:"),o.k0s(),o.EFF(5),o.j41(6,"strong"),o.EFF(7,"P\xe1gina:"),o.k0s(),o.EFF(8),o.j41(9,"strong"),o.EFF(10,"Exibindo:"),o.k0s(),o.EFF(11),o.k0s()(),o.j41(12,"div",3)(13,"div",4)(14,"app-button",5),o.bIt("click",function(){o.eBV(c);const u=o.XpG();return o.Njj(u.goToPage(0))}),o.nrm(15,"i",6),o.EFF(16," Primeira "),o.k0s(),o.j41(17,"app-button",5),o.bIt("click",function(){o.eBV(c);const u=o.XpG();return o.Njj(u.goToPage(u.currentPage-1))}),o.nrm(18,"i",7),o.EFF(19," Anterior "),o.k0s(),o.j41(20,"app-button",8),o.nrm(21,"i",9),o.EFF(22),o.k0s(),o.j41(23,"app-button",5),o.bIt("click",function(){o.eBV(c);const u=o.XpG();return o.Njj(u.goToPage(u.currentPage+1))}),o.nrm(24,"i",10),o.EFF(25," Pr\xf3xima "),o.k0s(),o.j41(26,"app-button",5),o.bIt("click",function(){o.eBV(c);const u=o.XpG();return o.Njj(u.goToPage(u.totalPages-1))}),o.nrm(27,"i",11),o.EFF(28," \xdaltima "),o.k0s()()()()}if(2&m){const c=o.XpG();o.R7$(5),o.SpI(" ",c.page.total_elements," registros | "),o.R7$(3),o.Lme(" ",c.page.number+1," de ",c.page.total_pages," | "),o.R7$(3),o.SpI(" ",c.page.number_of_elements," itens"),o.R7$(3),o.Y8G("disabled",c.isFirstPage()),o.R7$(3),o.Y8G("disabled",c.isFirstPage()),o.R7$(3),o.Y8G("disabled",!0),o.R7$(2),o.SpI(" ",c.currentPage+1," "),o.R7$(),o.Y8G("disabled",c.isLastPage()),o.R7$(3),o.Y8G("disabled",c.isLastPage())}}let C=(()=>{class m{constructor(){this.page=null,this.pageChange=new o.bkB}get currentPage(){return this.page?.number||0}get totalPages(){return this.page?.total_pages||0}isFirstPage(){return!!this.page&&this.page.first}isLastPage(){return!this.page||this.page.last}goToPage(c){c>=0&&c<this.totalPages&&this.pageChange.emit(c)}static{this.\u0275fac=function(h){return new(h||m)}}static{this.\u0275cmp=o.VBU({type:m,selectors:[["app-pagination"]],inputs:{page:"page"},outputs:{pageChange:"pageChange"},decls:1,vars:1,consts:[["class","d-flex flex-wrap justify-content-between align-items-center",4,"ngIf"],[1,"d-flex","flex-wrap","justify-content-between","align-items-center"],[1,"mb-2"],[1,"d-flex","gap-2","flex-wrap"],[1,"d-flex","gap-2","align-items-center","justify-content-end","pt-2","flex-wrap"],["btnType","primary","outline","",3,"click","disabled"],[1,"mdi","mdi-chevron-double-left"],[1,"mdi","mdi-chevron-left"],["btnType","primary","outline","",3,"disabled"],[1,"mdi","mdi-cellphone-link"],[1,"mdi","mdi-chevron-right"],[1,"mdi","mdi-chevron-double-right"]],template:function(h,u){1&h&&o.DNE(0,v,29,10,"div",0),2&h&&o.Y8G("ngIf",u.page)},dependencies:[l.bT,g.Q],encapsulation:2})}}return m})()},9362:(E,f,s)=>{s.r(f),s.d(f,{InvoiceModule:()=>le});var o=s(177),l=s(9417),g=s(9005),v=s(8147),C=s(5464),m=s(6411),F=s(1022),c=s(255),h=s(115),u=s(3887),T=s(1114),b=s(1188),e=s(4438),$=s(5312),x=s(1626);let k=(()=>{class r{constructor(t){this.http=t,this.apiUrl=`${$.c.apiUrl}/invoice`}get(){return this.http.get(this.apiUrl)}paginate(t){return this.http.post(`${this.apiUrl}/paginate`,t)}create(t){return this.http.post(`${this.apiUrl}/all`,t)}update(t){return this.http.put(this.apiUrl,t)}delete(t){return this.http.delete(`${this.apiUrl}/${t}`)}preview(t){return this.http.get(`${this.apiUrl}/preview/${t}`)}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(x.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var M=s(7509),V=s(9459),j=s(6356),w=s(7186),I=s(43),G=s(272),D=s(9986),B=s(1272),A=s(6436);function N(r,d){if(1&r){const t=e.RV6();e.j41(0,"tr",9),e.bIt("dblclick",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.onDoubleClick(i))}),e.j41(1,"td"),e.EFF(2),e.nI1(3,"reference"),e.k0s(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.nI1(15,"currency"),e.k0s(),e.j41(16,"td",10)(17,"ul",11)(18,"li",12),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.edit(i))}),e.nrm(19,"i",13),e.k0s(),e.j41(20,"li",14),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.delete(i))}),e.j41(21,"a",15),e.nrm(22,"i",16),e.k0s()()()()()}if(2&r){const t=d.$implicit;e.R7$(2),e.JRh(e.bMT(3,6,t.reference)),e.R7$(3),e.JRh(e.bMT(6,8,t.due_date)),e.R7$(3),e.JRh(t.number),e.R7$(2),e.JRh(t.place.address.name+" "+t.place.number+" "+t.place.letter),e.R7$(2),e.JRh(t.customer.name),e.R7$(2),e.JRh(e.bMT(15,10,t.total))}}let S=(()=>{class r{constructor(t,n,i,a,p){this.router=t,this.route=n,this.invoiceService=i,this.modalService=a,this.toastService=p,this.filter={page:0,size:10,sort_orders:[{property:"created_at",direction:"DESC"}]},this.loading=!0}ngOnInit(){this.search()}search(){this.loading=!0,this.invoiceService.paginate(this.filter).subscribe({next:t=>{this.page=t,this.loading=!1},error:()=>{this.loading=!1}})}onPageChange(t){this.filter.page=t-1,this.search()}onDoubleClick(t){this.view(t)}view(t){this.router.navigate(["view"],{relativeTo:this.route,state:{invoice:t}})}create(){this.router.navigate(["create"],{relativeTo:this.route})}edit(t){}delete(t){}openModal(t,n){const a=this.modalService.open(t,{centered:!0}).componentInstance;n&&Object.assign(a,n),a.sent.subscribe(()=>this.search())}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(b.Ix),e.rXU(b.nX),e.rXU(k),e.rXU(g.Bq),e.rXU(M.f))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-invoice"]],decls:31,vars:2,consts:[[1,"row"],[1,"col-lg-12"],[1,"card-title","flex-grow-1","mb-0"],[1,"d-flex","gap-1","flex-wrap"],["btnType","success","outline","",3,"click"],["table-header","",1,"table-light"],["table-body","",1,"list","form-check-all"],[3,"dblclick",4,"ngFor","ngForOf"],[3,"pageChange","page"],[3,"dblclick"],[1,"text-center"],[1,"list-inline","hstack","gap-2","mb-0"],["data-bs-toggle","tooltip","data-bs-trigger","hover","ngbTooltip","Edit","placement","top",1,"list-inline-item","edit",3,"click"],[1,"ri-pencil-fill","fs-16"],["ngbTooltip","Remove","placement","top","data-bs-toggle","tooltip","data-bs-trigger","hover",1,"list-inline-item","me-0",3,"click"],[1,"text-danger","d-inline-block","remove-item-btn"],[1,"ri-delete-bin-5-fill","fs-16"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"app-card")(3,"app-card-header")(4,"h5",2),e.EFF(5,"Faturas"),e.k0s(),e.j41(6,"div",3)(7,"app-button",4),e.bIt("click",function(){return i.create()}),e.EFF(8," Adicionar "),e.k0s()()(),e.j41(9,"app-card-body")(10,"app-table")(11,"thead",5)(12,"tr")(13,"th"),e.EFF(14,"Referer\xeancia"),e.k0s(),e.j41(15,"th"),e.EFF(16,"Vencimento"),e.k0s(),e.j41(17,"th"),e.EFF(18,"N\xfamero"),e.k0s(),e.j41(19,"th"),e.EFF(20,"Endere\xe7o"),e.k0s(),e.j41(21,"th"),e.EFF(22,"Cliente"),e.k0s(),e.j41(23,"th"),e.EFF(24,"Total"),e.k0s(),e.j41(25,"th"),e.EFF(26,"A\xe7\xf5es"),e.k0s()()(),e.j41(27,"tbody",6),e.DNE(28,N,23,12,"tr",7),e.k0s()()(),e.j41(29,"app-card-footer")(30,"app-pagination",8),e.bIt("pageChange",function(p){return i.onPageChange(p)}),e.k0s()()()()()),2&n&&(e.R7$(28),e.Y8G("ngForOf",i.page.content),e.R7$(2),e.Y8G("page",i.page))},dependencies:[o.Sq,V.Q,j.i,w.l,I.q,G.R,D.O,B.e,o.oe,o.vh,A.o],encapsulation:2})}}return r})();function P(r,d){if(1&r){const t=e.RV6();e.j41(0,"li")(1,"a",7),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.selectMonth(i))}),e.EFF(2),e.k0s()()}if(2&r){const t=d.$implicit;e.R7$(2),e.SpI(" ",t.label," ")}}function O(r,d){1&r&&(e.j41(0,"div",8),e.EFF(1,"Data inv\xe1lida"),e.k0s())}let U=(()=>{class r{constructor(){this.dayControl=new l.MJ("",[l.k0.required,l.k0.min(1),l.k0.max(31),l.k0.pattern(/^[0-9]{1,2}$/)]),this.monthControl=new l.MJ("",[l.k0.required]),this.yearControl=new l.MJ("",[l.k0.required,l.k0.minLength(4),l.k0.maxLength(4),l.k0.pattern(/^[0-9]{4}$/)]),this.months=[{value:"01",label:"Janeiro"},{value:"02",label:"Fevereiro"},{value:"03",label:"Mar\xe7o"},{value:"04",label:"Abril"},{value:"05",label:"Maio"},{value:"06",label:"Junho"},{value:"07",label:"Julho"},{value:"08",label:"Agosto"},{value:"09",label:"Setembro"},{value:"10",label:"Outubro"},{value:"11",label:"Novembro"},{value:"12",label:"Dezembro"}],this.selectedMonth=null,this.selectedMonthLabel=null,this.onChange=()=>{},this.onTouched=()=>{},this.dayControl.valueChanges.subscribe(()=>this.updateDate()),this.yearControl.valueChanges.subscribe(()=>this.updateDate())}ngOnChanges(t){t.submitted&&!0===t.submitted.currentValue&&!0!==t.submitted.previousValue&&(this.dayControl.markAsTouched(),this.monthControl.markAsTouched(),this.yearControl.markAsTouched())}writeValue(t){if(t){const[n,i,a]=t.split("-");this.yearControl.setValue(n,{emitEvent:!1}),this.dayControl.setValue(a,{emitEvent:!1});const p=this.months.find(_=>_.value===i);p&&(this.selectedMonth=p.value,this.selectedMonthLabel=p.label)}}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){t?(this.dayControl.disable(),this.monthControl.disable(),this.yearControl.disable()):(this.dayControl.enable(),this.monthControl.enable(),this.yearControl.enable())}validate(t){return this.dayControl.invalid||this.yearControl.invalid||!this.selectedMonth?{dateInvalid:!0}:null}isInvalid(){return!!this.submitted&&(this.dayControl.touched&&this.dayControl.invalid||this.yearControl.touched&&this.yearControl.invalid||!this.selectedMonth)}isValid(){return!!this.submitted&&this.dayControl.valid&&this.yearControl.valid&&!!this.selectedMonth}selectMonth(t){this.selectedMonth=t.value,this.selectedMonthLabel=t.label,this.updateDate()}updateDate(){if(this.selectedMonth&&this.yearControl.valid&&this.dayControl.valid){const t=String(this.dayControl.value).padStart(2,"0");this.onChange(`${this.yearControl.value}-${this.selectedMonth}-${t}`)}else this.onChange(null)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-input-date"]],inputs:{submitted:"submitted"},features:[e.Jv_([{provide:l.kq,useExisting:(0,e.Rfq)(()=>r),multi:!0},{provide:l.cz,useExisting:(0,e.Rfq)(()=>r),multi:!0}]),e.OA$],decls:8,vars:5,consts:[[1,"input-group"],["type","text","maxlength","2","placeholder","Dia",1,"form-control",3,"formControl"],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-outline-primary","dropdown-toggle"],[1,"dropdown-menu"],[4,"ngFor","ngForOf"],["type","text","maxlength","4","placeholder","Ano",1,"form-control",3,"formControl"],["class","text-danger",4,"ngIf"],[1,"dropdown-item",3,"click"],[1,"text-danger"]],template:function(n,i){1&n&&(e.j41(0,"div",0),e.nrm(1,"input",1),e.j41(2,"button",2),e.EFF(3),e.k0s(),e.j41(4,"ul",3),e.DNE(5,P,3,1,"li",4),e.k0s(),e.nrm(6,"input",5),e.k0s(),e.DNE(7,O,2,0,"div",6)),2&n&&(e.R7$(),e.Y8G("formControl",i.dayControl),e.R7$(2),e.SpI(" ",i.selectedMonthLabel||"M\xeas"," "),e.R7$(2),e.Y8G("ngForOf",i.months),e.R7$(),e.Y8G("formControl",i.yearControl),e.R7$(),e.Y8G("ngIf",i.isInvalid()))},dependencies:[o.Sq,o.bT,l.me,l.BC,l.tU,l.l_],encapsulation:2})}}return r})();var X=s(4988);const y=r=>({"table-success":r});function Y(r,d){if(1&r){const t=e.RV6();e.j41(0,"app-card")(1,"app-card-body")(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),e.EFF(6,"Refer\xeancia"),e.k0s(),e.j41(7,"app-input-reference",6),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.reference,i)||(a.reference=i),e.Njj(i)}),e.bIt("keydown.enter",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.search())}),e.k0s()()(),e.nrm(8,"hr"),e.j41(9,"div",7)(10,"div",8)(11,"label",9),e.EFF(12,"Buscar"),e.k0s(),e.j41(13,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.search())}),e.nrm(14,"i",11),e.EFF(15," Buscar"),e.k0s()()()()()()}if(2&r){const t=e.XpG();e.R7$(7),e.R50("ngModel",t.reference)}}function J(r,d){if(1&r&&(e.j41(0,"option",18),e.EFF(1),e.k0s()),2&r){const t=d.$implicit;e.Y8G("ngValue",t),e.R7$(),e.JRh(t)}}function L(r,d){if(1&r&&(e.j41(0,"option",18),e.EFF(1),e.k0s()),2&r){const t=d.$implicit;e.Y8G("ngValue",t),e.R7$(),e.JRh(t)}}function z(r,d){if(1&r){const t=e.RV6();e.j41(0,"tr",43),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.checked=!i.checked)}),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.nI1(9,"currency"),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td",44),e.EFF(13),e.nI1(14,"currency"),e.k0s()()}if(2&r){const t=d.$implicit;e.Y8G("ngClass",e.eq3(11,y,t.checked)),e.R7$(2),e.JRh(t.place.number),e.R7$(2),e.JRh(t.customer.name),e.R7$(2),e.JRh(t.category.name),e.R7$(2),e.JRh(e.bMT(9,7,t.water_value)),e.R7$(3),e.JRh(t.consumption),e.R7$(2),e.JRh(e.bMT(14,9,t.total))}}function H(r,d){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"tr",39),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.toggleGroup(i))}),e.j41(2,"td",40)(3,"div",7)(4,"div",41),e.EFF(5),e.k0s()()()(),e.DNE(6,z,15,13,"tr",42),e.bVm()}if(2&r){const t=d.$implicit,n=e.XpG(2);e.R7$(),e.Y8G("ngClass",e.eq3(4,y,t.checked)),e.R7$(4),e.JRh(t.name),e.R7$(),e.Y8G("ngForOf",t.items)("ngForTrackBy",n.trackBySelectableId)}}function W(r,d){if(1&r){const t=e.RV6();e.j41(0,"div",12)(1,"div")(2,"div",13)(3,"div",14)(4,"div",15)(5,"div",7)(6,"div",16)(7,"label",5),e.EFF(8,"Categorias:"),e.k0s(),e.j41(9,"select",17),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.filter.category,i)||(a.filter.category=i),e.Njj(i)}),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onchangeFilter())}),e.j41(10,"option",18),e.EFF(11,"Selecione..."),e.k0s(),e.DNE(12,J,2,2,"option",19),e.k0s()(),e.j41(13,"div",16)(14,"label",5),e.EFF(15,"Logradouro:"),e.k0s(),e.j41(16,"select",17),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.filter.address,i)||(a.filter.address=i),e.Njj(i)}),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onchangeFilter())}),e.j41(17,"option",18),e.EFF(18,"Selecione..."),e.k0s(),e.DNE(19,L,2,2,"option",19),e.k0s()(),e.j41(20,"div",16)(21,"label",5),e.EFF(22,"Tem Hidr\xf4metro?:"),e.k0s(),e.j41(23,"select",20),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.filter.hasMeter,i)||(a.filter.hasMeter=i),e.Njj(i)}),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onchangeFilter())}),e.j41(24,"option",18),e.EFF(25,"Selecione..."),e.k0s(),e.j41(26,"option",18),e.EFF(27,"Sim"),e.k0s(),e.j41(28,"option",18),e.EFF(29,"N\xe3o"),e.k0s()()()()()()()(),e.j41(30,"div")(31,"div",21)(32,"div",22)(33,"table",23)(34,"thead",24)(35,"tr",25),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.toggleAll())}),e.j41(36,"th",26),e.EFF(37,"N\xfamero"),e.k0s(),e.j41(38,"th",27),e.EFF(39,"Categoria"),e.k0s(),e.j41(40,"th",28),e.EFF(41,"Name"),e.k0s(),e.j41(42,"th",29),e.EFF(43,"\xc1gua/lt"),e.k0s(),e.j41(44,"th",29),e.EFF(45,"\xc1gua/Consumo"),e.k0s(),e.j41(46,"th",30),e.EFF(47,"Valor"),e.k0s()()(),e.j41(48,"tbody",31),e.DNE(49,H,7,6,"ng-container",32),e.k0s()()()()(),e.j41(50,"div")(51,"div",33)(52,"app-card")(53,"app-card-body")(54,"div",7)(55,"div",34),e.EFF(56),e.k0s(),e.j41(57,"div",34),e.EFF(58),e.nI1(59,"currency"),e.k0s(),e.j41(60,"div",34),e.EFF(61),e.k0s(),e.j41(62,"div",34),e.EFF(63),e.nI1(64,"currency"),e.k0s()()(),e.j41(65,"app-card-body")(66,"div",2)(67,"div",7)(68,"div",35)(69,"div")(70,"label",36),e.EFF(71,"Data de vencimento"),e.k0s(),e.j41(72,"app-input-date",37),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.dueDate,i)||(a.dueDate=i),e.Njj(i)}),e.k0s()()()(),e.j41(73,"div",38)(74,"div",35)(75,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.confirm())}),e.EFF(76,"Confirmar"),e.k0s()()()()()()()()()}if(2&r){const t=e.XpG();e.R7$(9),e.R50("ngModel",t.filter.category),e.R7$(),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngForOf",t.categories),e.R7$(4),e.R50("ngModel",t.filter.address),e.R7$(),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngForOf",t.addresses),e.R7$(4),e.R50("ngModel",t.filter.hasMeter),e.R7$(),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngValue",!0),e.R7$(2),e.Y8G("ngValue",!1),e.R7$(21),e.Y8G("ngForOf",t.preview.items)("ngForTrackBy",t.trackByGroupId),e.R7$(7),e.SpI("Total de items: ",t.totalItems(),""),e.R7$(2),e.SpI("Valor Total: ",e.bMT(59,17,t.totalValue()),""),e.R7$(3),e.SpI("Items Selecionados: ",t.totalISelectedtems(),""),e.R7$(2),e.SpI("Valor Selecionado: ",e.bMT(64,19,t.totalSelectedValue()),""),e.R7$(9),e.R50("ngModel",t.dueDate)}}let Q=(()=>{class r{constructor(t){this.service=t,this.reference=null,this.dueDate=null,this.preview={items:[]},this.loading=!0,this.invoices=[],this.addresses=[],this.categories=[],this.filter={hasMeter:null,address:null,category:null}}ngOnInit(){}search(){this.loading=!0,this.reference&&this.service.preview(this.reference).subscribe({next:t=>{this.invoices=t,this.preview=this.buildPreview(t),this.loading=!1},error:()=>{this.loading=!1,this.preview.items=[]}})}confirm(){const t=this.preview.items.flatMap(n=>n.items).filter(n=>n.checked);t.forEach(n=>{n.due_date=this.dueDate}),this.service.create(t).subscribe({next:()=>{this.preview.items=this.preview.items.map(n=>{const i=n.items.filter(a=>!a.checked);return{...n,items:i,count:i.length}}).filter(n=>n.count>0)},error:()=>{}})}filterByHasMeter(t){return null===this.filter.hasMeter?t:t.filter(n=>n.category.is_hydrometer===this.filter.hasMeter)}filterByAddress(t){return this.filter.address?t.filter(n=>n.place.address.name===this.filter.address):t}filterByCategory(t){return this.filter.category?t.filter(n=>n.category.name===this.filter.category):t}onchangeFilter(){let t=[...this.invoices];t=this.filterByHasMeter(t),t=this.filterByAddress(t),t=this.filterByCategory(t),this.preview=this.buildPreview(t)}getUniqueAddresses(t){return Array.from(new Set(t.map(n=>n.place.address.name))).sort((n,i)=>n.localeCompare(i))}getUniqueCategories(t){return Array.from(new Set(t.map(n=>n.category.name))).sort((n,i)=>n.localeCompare(i))}createSelectableInvoices(t){return t.map(n=>({checked:!1,...n}))}buildPreview(t){const n=this.createSelectableInvoices(t),i=this.getUniqueAddresses(n),a=this.getUniqueCategories(n),p=i.map(_=>{const R=n.filter(ce=>ce.place.address.name===_);return{name:_,checked:!1,items:R,count:R.length}}).filter(_=>_.count>0);return 0===this.addresses.length&&(this.addresses=i),0===this.categories.length&&(this.categories=a),{items:p}}trackByGroupId(t){return t.id}trackBySelectableId(t){return t.id}totalItems(){return this.preview.items.reduce((t,n)=>t+n.items.length,0)}totalValue(){return this.preview.items.reduce((t,n)=>t+n.items.reduce((i,a)=>i+Number(a.total),0),0)}totalISelectedtems(){return this.preview.items.reduce((t,n)=>t+n.items.filter(i=>i.checked).length,0)}totalSelectedValue(){return this.preview.items.reduce((t,n)=>t+n.items.filter(i=>i.checked).reduce((i,a)=>i+(Number(a.total)??0),0),0)}toggleGroup(t){t.checked=!t.checked,t.items.forEach(n=>n.checked=t.checked)}toggleAll(){const t=this.preview.items.every(n=>n.checked&&n.items.every(i=>i.checked));this.preview.items.forEach(n=>{n.checked=!t,n.items.forEach(i=>i.checked=!t)})}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(k))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-invoice-create"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","d-flex flex-column",4,"ngIf"],[1,"container-fluid"],[1,"row","g-2","align-items-end"],[1,"col-md-6","col-12"],[1,"form-label"],[3,"ngModelChange","keydown.enter","ngModel"],[1,"row"],[1,"col-12","col-md-4","offset-md-8","d-grid"],[1,"form-label","invisible"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"mdi","mdi-magnify"],[1,"d-flex","flex-column"],[1,"border"],[1,"card"],[1,"card-body"],[1,"col-xxl-4","col-md-6"],["id","group",1,"form-select",3,"ngModelChange","change","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["id","hasMeterFilter",1,"form-select",3,"ngModelChange","change","ngModel"],[1,"border","d-flex","flex-column"],[1,"border","mb-0","flex-grow-1","overflow-auto"],[1,"table","table-hover","table-bordered","table-striped","mb-0",2,"min-width","100%"],[1,"table-light",2,"position","sticky","top","0","z-index","1"],[2,"cursor","pointer",3,"click"],[2,"width","5%"],[2,"width","20%"],[2,"width","35%"],[2,"width","10%"],[1,"text-center",2,"width","10%"],["table-body","",1,"list","form-check-all"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"border","h-100"],[1,"col-md-3","col-12"],[1,"col-12","col-md-3","offset-md-9","d-grid"],["for","exampleInputdate",1,"form-label"],[3,"ngModelChange","ngModel"],[1,"row","mt-3"],[1,"bg-light",3,"click","ngClass"],["colspan","6"],[1,"text-center","fw-bold",2,"font-size","16px"],["style","cursor: pointer",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[2,"cursor","pointer",3,"click","ngClass"],[1,"text-center"]],template:function(n,i){1&n&&e.DNE(0,Y,16,1,"app-card",0)(1,W,77,21,"div",1),2&n&&(e.Y8G("ngIf",i.loading),e.R7$(),e.Y8G("ngIf",!i.loading))},dependencies:[o.YU,o.Sq,o.bT,j.i,I.q,U,X.F,l.xH,l.y7,l.wz,l.BC,l.vS,o.oe],encapsulation:2})}}return r})(),K=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-invoice-view-header"]],decls:27,vars:0,consts:[[1,"mb-3"],[1,"d-flex","justify-content-between"],[2,"flex","1"],["src","assets/images/acal/acal.jpg","alt","Logo ACAL"],[2,"flex","6"],[1,"h5"],[1,"row","border-top","border-bottom","text-center"],[1,"col-12"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.nrm(3,"img",3),e.k0s(),e.j41(4,"div",4)(5,"p",5),e.EFF(6," CNPJ - 13.228.119/0001-68"),e.nrm(7,"br"),e.EFF(8," Publica\xe7\xe3o do estatuto no Di\xe1rio Oficial de 22-06-1983."),e.nrm(9,"br"),e.EFF(10," Reconhecido como \xd3rg\xe3o de utilidade p\xfablica Municipal - conf.lei N 7 de 27-10-1983."),e.nrm(11,"br"),e.EFF(12," Reconhecido como \xd3rg\xe3o de utilidade p\xfablica Estadual - conf.lei N 7049 de 16-04-1997."),e.nrm(13,"br"),e.EFF(14," Rua Morro do Chap\xe9u, CEP 44709-000, S/N. Telefone: (74) 9 8107-4362"),e.nrm(15,"br"),e.EFF(16," Lages do Batata - Jacobina, BA."),e.nrm(17,"br"),e.EFF(18," Email: acallages@hotmail.com "),e.k0s()()(),e.j41(19,"div",6)(20,"div",7)(21,"h2")(22,"u"),e.EFF(23,"ACAL - Associa\xe7\xe3o Comunit\xe1ria e Assist\xeancial de Lages"),e.k0s()(),e.j41(24,"h6")(25,"u"),e.EFF(26,"ECONOMIZAR \xc1GUA \xc9 UM DEVER DE TODO SER HUMANO."),e.k0s()()()()())},encapsulation:2})}}return r})();var Z=s(922);function q(r,d){if(1&r&&(e.j41(0,"span")(1,"div",9)(2,"div",10)(3,"h2",11),e.EFF(4,"Pago em:"),e.k0s(),e.j41(5,"p",11),e.EFF(6),e.nI1(7,"date"),e.k0s()()()()),2&r){const t=e.XpG();e.R7$(6),e.JRh(e.bMT(7,1,t.invoice.paid_at))}}function ee(r,d){if(1&r&&(e.j41(0,"tr")(1,"td")(2,"strong"),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"currency"),e.k0s()()),2&r){const t=d.$implicit;e.R7$(3),e.SpI("",t.name,":"),e.R7$(2),e.JRh(e.bMT(6,2,t.value))}}let te=(()=>{class r{ngOnInit(){}get now(){return new Date}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-invoice-view-detail"]],inputs:{invoice:"invoice"},decls:74,vars:23,consts:[[1,"row","mb-3"],[1,"d-flex","justify-content-between",2,"gap","1rem"],[1,"border","rounded","text-center",2,"flex","1"],[1,"border","rounded",2,"flex","1"],[1,"table-responsive"],[1,"table","table-striped","table-bordered"],[1,"border","rounded",2,"flex","1","min-height","200px"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"container","h-100","d-flex","justify-content-center","align-items-center"],[1,"text-center"],[1,"mb-0"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"strong"),e.EFF(4,"N\xba de Associado"),e.k0s(),e.nrm(5,"br"),e.EFF(6),e.k0s(),e.j41(7,"div",2)(8,"strong"),e.EFF(9,"Boleto n\xba:"),e.k0s(),e.nrm(10,"br"),e.EFF(11),e.k0s(),e.j41(12,"div",2)(13,"strong"),e.EFF(14,"Conta referente:"),e.k0s(),e.nrm(15,"br"),e.EFF(16),e.k0s()()(),e.j41(17,"div",0)(18,"div",1)(19,"div",3)(20,"div",4)(21,"table",5)(22,"tr")(23,"td")(24,"strong"),e.EFF(25,"S\xf3cio:"),e.k0s()(),e.j41(26,"td"),e.EFF(27),e.k0s()(),e.j41(28,"tr")(29,"td")(30,"strong"),e.EFF(31,"Endere\xe7o:"),e.k0s()(),e.j41(32,"td"),e.EFF(33),e.k0s()(),e.j41(34,"tr")(35,"td")(36,"strong"),e.EFF(37,"Local:"),e.k0s()(),e.j41(38,"td"),e.EFF(39,"Lages do Batata - Jacobina BA."),e.k0s()(),e.j41(40,"tr")(41,"td")(42,"strong"),e.EFF(43,"Categoria:"),e.k0s()(),e.j41(44,"td"),e.EFF(45),e.nI1(46,"group"),e.k0s()()()()(),e.j41(47,"div",6),e.DNE(48,q,8,3,"span",7),e.k0s(),e.j41(49,"div",3)(50,"div",4)(51,"table",5)(52,"tr")(53,"td")(54,"strong"),e.EFF(55,"Data de Emiss\xe3o:"),e.k0s()(),e.j41(56,"td"),e.EFF(57),e.nI1(58,"date"),e.k0s()(),e.j41(59,"tr")(60,"td")(61,"strong"),e.EFF(62,"Vencimento:"),e.k0s()(),e.j41(63,"td"),e.EFF(64),e.nI1(65,"date"),e.k0s()(),e.DNE(66,ee,7,4,"tr",8),e.j41(67,"tr")(68,"td")(69,"strong"),e.EFF(70,"Valor total::"),e.k0s()(),e.j41(71,"td"),e.EFF(72),e.nI1(73,"currency"),e.k0s()()()()()()()),2&n&&(e.R7$(6),e.SpI(" ",i.invoice.customer.partner_number," "),e.R7$(5),e.SpI(" ",i.invoice.number," "),e.R7$(5),e.SpI(" ",i.invoice.reference," "),e.R7$(11),e.JRh(i.invoice.customer.name),e.R7$(6),e.E5c("",i.invoice.place.address.name," ",i.invoice.place.number,"",i.invoice.place.letter,""),e.R7$(12),e.Lme("",e.bMT(46,14,i.invoice.category.group)," ",i.invoice.category.name,""),e.R7$(3),e.Y8G("ngIf",i.invoice.paid_at),e.R7$(9),e.JRh(e.i5U(58,16,i.now,"dd/MM/yyyy")),e.R7$(7),e.JRh(e.bMT(65,19,i.invoice.due_date)),e.R7$(2),e.Y8G("ngForOf",i.invoice.values),e.R7$(6),e.JRh(e.bMT(73,21,i.invoice.total)))},dependencies:[o.Sq,o.bT,o.oe,o.vh,Z.c],encapsulation:2})}}return r})();function ne(r,d){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s()()),2&r){const t=d.$implicit;e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.required),e.R7$(2),e.JRh(t.analyzed),e.R7$(2),e.JRh(t.conformity)}}let ie=(()=>{class r{ngOnInit(){}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-invoice-view-water-quality"]],inputs:{invoice:"invoice"},decls:34,vars:1,consts:[[1,"text-center","mb-2"],[1,"table-responsive","mb-3"],[1,"table","table-bordered","table-striped","text-center"],[1,"table-light"],[4,"ngFor","ngForOf"],[1,"mb-3","small-text"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"strong"),e.EFF(2,"PADR\xc3O DA PORTARIA MS 2914/2011"),e.k0s(),e.nrm(3,"br"),e.EFF(4," Decreto Federal n\xba. 5.440/2005\n"),e.k0s(),e.j41(5,"div",1)(6,"table",2)(7,"thead",3)(8,"tr")(9,"th"),e.EFF(10,"Par\xe2metros"),e.k0s(),e.j41(11,"th"),e.EFF(12,"Exigidas"),e.k0s(),e.j41(13,"th"),e.EFF(14,"Analisadas"),e.k0s(),e.j41(15,"th"),e.EFF(16,"Em Conformidade"),e.k0s()()(),e.j41(17,"tbody"),e.DNE(18,ne,9,4,"tr",4),e.k0s()()(),e.j41(19,"div",5)(20,"strong"),e.EFF(21,"Par\xe2metros de Qualidade da \xc1gua"),e.k0s(),e.nrm(22,"br"),e.j41(23,"ul")(24,"li"),e.EFF(25,"Coliformes Totais: Indicador que mensura contamina\xe7\xe3o bacteriol\xf3gica do tipo: bacilos gram-negativos, aer\xf3bios ou anaer\xf3bios facultativos n\xe3o esporog\xeanicos, oxidase-negativos."),e.k0s(),e.j41(26,"li"),e.EFF(27,"E. coli: Indicador que mensura contamina\xe7\xe3o bacteriol\xf3gica de origem fecal."),e.k0s(),e.j41(28,"li"),e.EFF(29,"Cloro Residual: Indicador do Poder Desinfetante oriundo do Cloro (Agente de Desinfec\xe7\xe3o)."),e.k0s(),e.j41(30,"li"),e.EFF(31,"Turbidez: Indicador do espalhamento de luz produzido pela presen\xe7a de part\xedculas em suspens\xe3o ou coloidais."),e.k0s(),e.j41(32,"li"),e.EFF(33,"Cor Aparente: Indicador que mensura a cor em amostras com turbidez."),e.k0s()()()),2&n&&(e.R7$(18),e.Y8G("ngForOf",i.invoice.water_quality.analysis))},dependencies:[o.Sq],encapsulation:2})}}return r})();function oe(r,d){if(1&r&&(e.j41(0,"span"),e.nrm(1,"app-invoice-view-water-quality",1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Y8G("invoice",t.invoice)}}const re=[{path:"",component:S},{path:"create",component:Q},{path:"view",component:(()=>{class r{constructor(t,n){this.router=t,this.route=n;const i=this.router.getCurrentNavigation();i?.extras?.state&&i.extras.state.invoice?this.invoice=i.extras.state.invoice:this.back()}back(){this.router.navigate(["../"],{relativeTo:this.route})}get status(){return this.invoice.paid_at?"Pago":"Aguardando"}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(b.Ix),e.rXU(b.nX))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-invoice-view"]],decls:14,vars:3,consts:[[1,"container","border"],[3,"invoice"],[4,"ngIf"],[1,"container","border","mt-3","mb-3"],[1,"row"],[1,"d-flex","justify-content-between","flex-wrap","gap-2"],["type","button",1,"btn","btn-success"],["type","button",1,"btn","btn-danger"],["type","button",1,"btn","btn-primary"]],template:function(n,i){1&n&&(e.j41(0,"div",0),e.nrm(1,"app-invoice-view-header")(2,"app-invoice-view-detail",1),e.DNE(3,oe,2,1,"span",2),e.nrm(4,"app-invoice-view-detail",1),e.k0s(),e.j41(5,"div",3)(6,"div",4)(7,"div",5)(8,"button",6),e.EFF(9,"Receber"),e.k0s(),e.j41(10,"button",7),e.EFF(11,"Apagar"),e.k0s(),e.j41(12,"button",8),e.EFF(13,"Voltar"),e.k0s()()()()),2&n&&(e.R7$(2),e.Y8G("invoice",i.invoice),e.R7$(),e.Y8G("ngIf",i.invoice.water_quality),e.R7$(),e.Y8G("invoice",i.invoice))},dependencies:[o.bT,K,te,ie],encapsulation:2})}}return r})()}];let ae=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[b.iI.forChild(re),b.iI]})}}return r})();var se=s(7038);let le=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({providers:[o.vh],imports:[u.G,ae,o.MD,v.h,h.i,l.YN,l.X1,g.c9,g.h_,g.zH,c.r,C.M.pick(m.Wzl),F.ND,T.V,se.H]})}}return r})()}}]);